import{_ as a,H as s,E as t,aj as l}from"./chunks/framework.CE5Mb3x2.js";const c=JSON.parse('{"title":"电子流旧项目上云","description":"","frontmatter":{},"headers":[],"relativePath":"work/61.match-apply-to-cloud.md","filePath":"work/61.match-apply-to-cloud.md","lastUpdated":1765646621000}'),e={name:"work/61.match-apply-to-cloud.md"};function p(h,i,n,k,o,r){return t(),s("div",null,i[0]||(i[0]=[l(`<div class="info custom-block"><p class="custom-block-title">作者</p><p>novlan1</p><p>2025.9.1</p></div><h1 id="电子流旧项目上云" tabindex="-1">电子流旧项目上云 <a class="header-anchor" href="#电子流旧项目上云" aria-label="Permalink to &quot;电子流旧项目上云&quot;">​</a></h1><p><code>igame.qq.com</code> 旧项目逐步上云，包括电子流的几个旧项目。</p><h2 id="_1-迁移步骤" tabindex="-1">1. 迁移步骤 <a class="header-anchor" href="#_1-迁移步骤" aria-label="Permalink to &quot;1. 迁移步骤&quot;">​</a></h2><ol><li>上云项目发布</li><li>旧项目重定向</li></ol><h2 id="_2-影响" tabindex="-1">2. 影响 <a class="header-anchor" href="#_2-影响" aria-label="Permalink to &quot;2. 影响&quot;">​</a></h2><p>好处</p><ol><li>维护一套发布流程</li><li>上云后支持回滚、灰度</li></ol><p>其他</p><ul><li>对用户影响：几乎无感知，重定向，登录态、缓存均生效</li><li>对开发、测试、产品经理影响：基本无</li></ul><h2 id="_3-实现方式" tabindex="-1">3. 实现方式 <a class="header-anchor" href="#_3-实现方式" aria-label="Permalink to &quot;3. 实现方式&quot;">​</a></h2><ol><li>业务项目中进行 <code>url</code> 匹配并重定向，而非 <code>nginx</code> 或 <code>apache</code>，好处是简单、灵活</li><li>重定向逻辑放到外链中，而非放到 <code>html</code> 中，好处是易调整</li><li><code>url</code> 中 <code>hash</code> 部分同样保留</li></ol><p>参数保留的验证链接：</p><ol><li>PC打开：<a href="https://igame.qq.com/tip/igame-web/match-apply/#/apply/authentification/10037bfffe1756689489?g=999010&amp;type=2" target="_blank" rel="noreferrer">https://igame.qq.com/tip/igame-web/match-apply/#/apply/authentification/10037bfffe1756689489?g=999010&amp;type=2</a></li><li>移动端打开：<a href="https://igame.qq.com/tip/igame-web/match-apply-mobile/#/audit/company/10037bfffe1756689489?type=2" target="_blank" rel="noreferrer">https://igame.qq.com/tip/igame-web/match-apply-mobile/#/audit/company/10037bfffe1756689489?type=2</a></li></ol><p>业务改动点：</p><ol><li>硬编码的改造，比如拼接的路径 <code>\${location.origin}/tip/igame-web</code></li></ol><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 改成</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> window.location.origin.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">indexOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;test&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;igame.qq.com&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;test.igame.qq.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// or</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> origin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> window.location.origin.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">indexOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;test&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;igame.qq.com&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;test.igame.qq.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div>`,17)]))}const g=a(e,[["render",p]]);export{c as __pageData,g as default};
